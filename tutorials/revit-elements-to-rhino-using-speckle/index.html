<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Revit Elements to Rhino Using Speckle | BIMGEEK</title>
<meta name="keywords" content="english, revit, excel, dynamo, speckle" />
<meta name="description" content="In this tutorial, we&rsquo;ll send some Revit elements to Rhino and the geometry in Rhino will contain selected Revit parameters. This workflow contains a lot of use cases but I will create a really simple script that will color Revit elements by their properties, just to demonstrate the structure of the data that comes from Speckle and how we can use it in the workflow.
Let&rsquo;s get started!üèÉ‚Äç‚ôÇÔ∏è
Prefer watching than reading?">
<meta name="author" content="BIMGEEK">
<link rel="canonical" href="https://bimgeek.github.io/tutorials/revit-elements-to-rhino-using-speckle/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.5b91b873370e32882b86d13a2016a76ff0c5a10e30b80b55e02e0323e1c1a068.css" integrity="sha256-W5G4czcOMogrhtE6IBanb/DFoQ4wuAtV4C4DI&#43;HBoGg=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js" integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://bimgeek.github.io/images/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://bimgeek.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://bimgeek.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://bimgeek.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://bimgeek.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.97.2" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<meta property="og:title" content="Revit Elements to Rhino Using Speckle" />
<meta property="og:description" content="In this tutorial, we&rsquo;ll send some Revit elements to Rhino and the geometry in Rhino will contain selected Revit parameters. This workflow contains a lot of use cases but I will create a really simple script that will color Revit elements by their properties, just to demonstrate the structure of the data that comes from Speckle and how we can use it in the workflow.
Let&rsquo;s get started!üèÉ‚Äç‚ôÇÔ∏è
Prefer watching than reading?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bimgeek.github.io/tutorials/revit-elements-to-rhino-using-speckle/" />
<meta property="og:image" content="https://bimgeek.github.io/images/Revit_to_Rhino.png" /><meta property="article:section" content="tutorials" />
<meta property="article:published_time" content="2022-01-13T22:09:19&#43;03:00" />
<meta property="article:modified_time" content="2022-01-13T22:09:19&#43;03:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://bimgeek.github.io/images/Revit_to_Rhino.png" />
<meta name="twitter:title" content="Revit Elements to Rhino Using Speckle"/>
<meta name="twitter:description" content="In this tutorial, we&rsquo;ll send some Revit elements to Rhino and the geometry in Rhino will contain selected Revit parameters. This workflow contains a lot of use cases but I will create a really simple script that will color Revit elements by their properties, just to demonstrate the structure of the data that comes from Speckle and how we can use it in the workflow.
Let&rsquo;s get started!üèÉ‚Äç‚ôÇÔ∏è
Prefer watching than reading?"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Tutorials",
      "item": "https://bimgeek.github.io/tutorials/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Revit Elements to Rhino Using Speckle",
      "item": "https://bimgeek.github.io/tutorials/revit-elements-to-rhino-using-speckle/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Revit Elements to Rhino Using Speckle",
  "name": "Revit Elements to Rhino Using Speckle",
  "description": "In this tutorial, we\u0026rsquo;ll send some Revit elements to Rhino and the geometry in Rhino will contain selected Revit parameters. This workflow contains a lot of use cases but I will create a really simple script that will color Revit elements by their properties, just to demonstrate the structure of the data that comes from Speckle and how we can use it in the workflow.\nLet\u0026rsquo;s get started!üèÉ‚Äç‚ôÇÔ∏è\nPrefer watching than reading?",
  "keywords": [
    "english", "revit", "excel", "dynamo", "speckle"
  ],
  "articleBody": "In this tutorial, we‚Äôll send some Revit elements to Rhino and the geometry in Rhino will contain selected Revit parameters. This workflow contains a lot of use cases but I will create a really simple script that will color Revit elements by their properties, just to demonstrate the structure of the data that comes from Speckle and how we can use it in the workflow.\nLet‚Äôs get started!üèÉ‚Äç‚ôÇÔ∏è\nPrefer watching than reading? Here‚Äôs a video too!   Tutorial Files You can access the Grasshopper definitions used in this tutorial down below üëá:\n\r.button {\rdisplay: flex;\rheight: 50px;\rpadding: 0;\rbackground: #DC3545;\rborder: none;\routline: none;\rborder-radius: 5px;\roverflow: hidden;\rfont-size: 16px;\rfont-weight: 600;\rcursor: pointer;\r}\r.button:hover {\rbackground: #C82333;\r}\r.button:active {\rbackground: #DC3545;\r}\r.button__text,\r.button__icon {\rdisplay: inline-flex;\ralign-items: center;\rpadding: 0 15px;\rcolor: #fff;\rheight: 100%;\r}\r.button__icon {\rfont-size: 1.5em;\rbackground: rgba(0, 0, 0, 0.05);\r}\r\r\r\rTutorial Files\r\r\r\rPrerequisites General Requirements To follow this tutorial you‚Äôll need the following:\n Revit 2018 - 2022 (I‚Äôll be using 2022) Rhino 6/7 (I‚Äôll use Rhino 7) a Speckle account (you can get one for freeüéâ at¬†https://speckle.xyz/) the Speckle Connector for Grasshopper (install it via¬†Manager) the Speckle Connector for Revit (install it via¬†Manager)  Since we are using Revit and Grasshopper to achieve the workflow, you need to have the basic knowledge of how to use both solutionsüòá\nGrasshopper Plugins When it comes to Grasshopper plugins, WombatGH and Elefront needed. Details to thatüëá:\nElefront\nWombatGH\nCreating a Stream and sending data from Revit Let‚Äôs open the document and create a new stream. It just takes three steps:\n Go to Add-Ins and open Revit connector. Click the blue button on the bottom right corner. Use text box to name your stream and click the ‚Äú+‚Äù button to create a new stream.  There are couple ways to send data from Revit. But we are going to do it the manual way.\n Choose what you want to send by selecting it. Click on the blue button in the middle of the card. Select the ‚ÄúSet selection‚Äù option And finally double click on Send to send data straight away.  Receiving in Grasshopper Receiving data is also super easy: you just need the link! Copy the URL and paste it in a Panel. Then just plug it into a ‚ÄúReceive‚Äù component and click the ‚ÄúReceive‚Äù button. Voila, the stream is received!\nDefining Object Attributes Lets start by examining the received data. When we connect a panel to the data output, we can see that the output is a Base object. The base object class (actually called Base) is the foundation of all data being transferred with Speckle.\nExpand Speckle Object Let‚Äôs connect a Expand Speckle Object node to display the contents of that Base object. Using the object converter, expand node outputs the contents of the Base object. Selected elements will be listed by their Speckle types.\nIn this example, we can see that our elements are grouped under 8 lists. We‚Äôll transfer Floors, Structural Columns, Structural Foundations, Structural Framing and Walls.\nFirst, we‚Äôll use Merge node to merge these lists and then Expand it again to see the attributes of received objects.\nThis time Expand Speckle Object node will output the attributes of the selected objects. In this tutorial we will use following attributes:\n displayMesh: displayMesh contains the geometry of the element. It will be received as mesh geometry in Rhino. elementId: Revit Element Id of the selected element. We are going to use the value of it as the name of the geometry. type: Type name of the Revit element. An example is ‚ÄúGeneric Concrete 300mm‚Äù. We will create a type attribute and set this as the value. speckle_type: Returns Speckle Type of the element. level: Level of the selected element. The value of this element will also be a Speckle Object and we only need the name of the level. So we will connect another expand Speckle object to get the parameter name.  Speckle Object Value by Key After we have the names of the attributes we are looking for, instead of connecting an Expand node, we can connect Speckle Object Value by Key node. This node expects an Object and a Key, and it returns the value of the given key.\nWe will connect the Merge result to the Object input of this node and connect the above parameters as the Key input.\nNow we have the keys and the values of the attributes, let‚Äôs create them. For that, we will use Define Object Attributes from Elefront.\n User Keys: This will be the merged list of the keys. In our case, type and level. User Values: Again, Merged list of the values of those keys. But be careful, you should graft the inputs to have two items in each list, one for the type and one for the level. Otherwise, you will end up with two lists. Name: The values of the elementId key. This will also be grafted. Layer: Layer will be the category of the elements. Also grafted. But first we have to define the layers. For that, we will use Define Layer node from Elefront to create Layers from unique names.  Do not forget to flatten the output depending on the structure of your lists.\nNow we created the attributes, let‚Äôs add them to the geometry. We will use Bake Objects from Elefront to bake mesh geometry with their corresponding attributes. Let‚Äôs give it a BakeName: ‚ÄúRevit to Rhino with Properties‚Äù. Bake input expects a Boolean so I will connect a Button to that. When I hit it, Boolean will turn True and it bakes the geometry.\nThis will be the final result.\nOther than geometry, we also have the information embedded in the model üéâüéâ\nColoring by Attributes In the previous part, we embedded the properties. There are potential use cases for it and we will demonstrate the first thing that comes to mind: Coloring them by their attributes in Rhino.\nLet‚Äôs do itüí™!\nReferencing Geometry Lets start with referencing the geometry we baked. Since they are Mesh, we can use Reference by Type node and connect Mesh as the input.\nGet Attribute Values Now we have the geometry, let‚Äôs get the attribute values. We will use Get User Value and connect ‚Äútype‚Äù string for the Key input. This will output Revit Type names as the output.\nCreate Color For Each Type Lets create a color for each unique types. We will convert our List to a Set to get unique items. Then we‚Äôll use Random Color from WombatGH to create a color for each item connected.\nCreate Color For Each Element Lets match these colors with corresponding elements. We‚Äôll use List Item to match the order of two lists and connect Map output of Set as the Index input of List Item.\nAdd Color to Geometry You‚Äôve made it so far, congratsüëè! Lets add colors to the geometry. First lets convert these colors to Elefront Attributes, then we have to modify the color attribute of the Rhino geometry and we will use Modify Rhino Attributes for that. Connect mesh geometry to the geometry input, Elefront attributes to the attributes input and a Boolean value of True to the modify input.\nColored by Type Attribute\nTa Da!üéäüéäüéä You‚Äôve made it. They are colored by their type attributes now! You can color it by any of its attributes. Try it yourselves. Below is colored by Level attribute instead of type.\nColored by Level Attribute\n Conclusion We hope you enjoyed this tutorial and found it useful!\nSpeckle is an Open Source project¬†and we really ‚ù§Ô∏è feedback, so if you have any questions, comments, critiques, or praises please let us know on our¬†community forum.\n",
  "wordCount" : "1289",
  "inLanguage": "en",
  "image":"https://bimgeek.github.io/images/Revit_to_Rhino.png","datePublished": "2022-01-13T22:09:19+03:00",
  "dateModified": "2022-01-13T22:09:19+03:00",
  "author":{
    "@type": "Person",
    "name": "BIMGEEK"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://bimgeek.github.io/tutorials/revit-elements-to-rhino-using-speckle/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "BIMGEEK",
    "logo": {
      "@type": "ImageObject",
      "url": "https://bimgeek.github.io/images/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://bimgeek.github.io/" accesskey="h" title="BIMGEEK (Alt + H)">BIMGEEK</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://bimgeek.github.io/tutorials" title="Tutorials">
                    <span>Tutorials</span>
                </a>
            </li>
            <li>
                <a href="https://bimgeek.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://bimgeek.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://bimgeek.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://bimgeek.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://bimgeek.github.io/">Home</a>&nbsp;¬ª&nbsp;<a href="https://bimgeek.github.io/tutorials/">Tutorials</a></div>
    <h1 class="post-title">
      Revit Elements to Rhino Using Speckle
    </h1>
    <div class="post-meta">January 13, 2022&nbsp;¬∑&nbsp;7 min&nbsp;¬∑&nbsp;BIMGEEK
</div>
  </header> 
  <div class="post-content"><p>In this tutorial, we&rsquo;ll send some Revit elements to Rhino and the geometry in Rhino will contain selected Revit parameters. This workflow contains a lot of use cases but I will create a really simple script that will color Revit elements by their properties, just to demonstrate the structure of the data that comes from Speckle and how we can use it in the workflow.</p>
<p>Let&rsquo;s get started!üèÉ‚Äç‚ôÇÔ∏è</p>
<h3 id="prefer-watching-than-reading-heres-a-video-too"><strong>Prefer watching than reading? Here&rsquo;s a video too!</strong><a hidden class="anchor" aria-hidden="true" href="#prefer-watching-than-reading-heres-a-video-too">#</a></h3>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube-nocookie.com/embed/LzXhjS4niD0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<h2 id="tutorial-files">Tutorial Files<a hidden class="anchor" aria-hidden="true" href="#tutorial-files">#</a></h2>
<p>You can access the Grasshopper definitions used in this tutorial down below üëá:</p>
<a href="tutorial-files-revit-elements-to-rhino-using-speckle.rar" download>
    <style>
    .button {
  display: flex;
  height: 50px;
  padding: 0;
  background: #DC3545;
  border: none;
  outline: none;
  border-radius: 5px;
  overflow: hidden;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
}

.button:hover {
  background: #C82333;
}

.button:active {
  background: #DC3545;
}

.button__text,
.button__icon {
  display: inline-flex;
  align-items: center;
  padding: 0 15px;
  color: #fff;
  height: 100%;
}

.button__icon {
  font-size: 1.5em;
  background: rgba(0, 0, 0, 0.05);
}

</style>

<button type="button" class="button">
    <span class="button__icon">
      <ion-icon name="file-tray-full"></ion-icon>
    </span>
    <span class="button__text">Tutorial Files</span>
  </button>
  <script src="https://unpkg.com/ionicons@5.4.0/dist/ionicons.js"></script>
</a>
<h2 id="prerequisites">Prerequisites<a hidden class="anchor" aria-hidden="true" href="#prerequisites">#</a></h2>
<h3 id="general-requirements">General Requirements<a hidden class="anchor" aria-hidden="true" href="#general-requirements">#</a></h3>
<p>To follow this tutorial you&rsquo;ll need the following:</p>
<ul>
<li>Revit 2018 - 2022 (I&rsquo;ll be using 2022)</li>
<li>Rhino 6/7 (I&rsquo;ll use Rhino 7)</li>
<li>a Speckle account (you can get one <strong>for freeüéâ</strong> at¬†<strong><a href="https://speckle.xyz/">https://speckle.xyz/</a></strong>)</li>
<li>the Speckle Connector for Grasshopper (install it via¬†<strong><a href="https://speckle.guide/user/manager.html">Manager</a></strong>)</li>
<li>the Speckle Connector for Revit (install it via¬†<strong><a href="https://speckle.guide/user/manager.html">Manager</a></strong>)</li>
</ul>
<p>Since we are using Revit and Grasshopper to achieve the workflow, you need to have the  basic knowledge of how to use both solutionsüòá</p>
<h3 id="grasshopper-plugins">Grasshopper Plugins<a hidden class="anchor" aria-hidden="true" href="#grasshopper-plugins">#</a></h3>
<p>When it comes to Grasshopper plugins, <strong>WombatGH</strong> and <strong>Elefront</strong> needed. Details to thatüëá:</p>
<p><a href="https://www.food4rhino.com/en/app/elefront">Elefront</a></p>
<p><a href="https://www.food4rhino.com/en/app/wombatgh">WombatGH</a></p>
<h2 id="creating-a-stream-and-sending-data-from-revit">Creating a Stream and sending data from Revit<a hidden class="anchor" aria-hidden="true" href="#creating-a-stream-and-sending-data-from-revit">#</a></h2>
<p><img loading="lazy" src="images/1_-_Create_a_Stream.gif" alt="1 - Create a Stream.gif"  />
</p>
<p>Let&rsquo;s open the document and create a new stream. It just takes three steps:</p>
<ol>
<li>Go to <strong>Add-Ins</strong> and open <strong>Revit connector</strong>.</li>
<li>Click the blue button on the <strong>bottom right corner</strong>.</li>
<li>Use text box to <strong>name</strong> your stream and click the &ldquo;<strong>+</strong>&rdquo; button to create a new stream.</li>
</ol>
<p><img loading="lazy" src="images/1.1_-_Sending_from_Revit.gif" alt="1.1 - Sending from Revit.gif"  />
</p>
<p>There are couple ways to send data from Revit. But we are going to do it the manual way.</p>
<ol>
<li>Choose what you want to send by <strong>selecting</strong> it.</li>
<li>Click on the <strong>blue button</strong> in the middle of the card.</li>
<li>Select the &ldquo;<strong>Set selection</strong>&rdquo; option</li>
<li>And finally <strong>double click</strong> on <strong>Send</strong> to send data straight away.</li>
</ol>
<h2 id="receiving-in-grasshopper">Receiving in Grasshopper<a hidden class="anchor" aria-hidden="true" href="#receiving-in-grasshopper">#</a></h2>
<p><img loading="lazy" src="images/2_-_Receive_in_Grasshopper.gif" alt="2 - Receive in Grasshopper.gif"  />
</p>
<p>Receiving data is also super easy: you just need the link! Copy the URL and paste it in a <strong>Panel</strong>. Then just plug it into a &ldquo;<strong>Receive</strong>&rdquo; component and click the &ldquo;<strong>Receive</strong>&rdquo; button. Voila, the stream is received!</p>
<h2 id="defining-object-attributes">Defining Object Attributes<a hidden class="anchor" aria-hidden="true" href="#defining-object-attributes">#</a></h2>
<p>Lets start by examining the received data. When we connect a panel to the data output, we can see that the output is a <strong>Base object.</strong> The base object class (actually called <code>Base</code>) is the foundation of all data being transferred with Speckle.</p>
<p><img loading="lazy" src="images/3.1-Defining_Object_Attributes.png" alt="3.1-Defining_Object_Attributes.png"  />
</p>
<h3 id="expand-speckle-object">Expand Speckle Object<a hidden class="anchor" aria-hidden="true" href="#expand-speckle-object">#</a></h3>
<p>Let&rsquo;s connect a <strong>Expand Speckle Object</strong> node to display the contents of that Base object. Using the object converter, expand node outputs the contents of the Base object. Selected elements will be listed by their Speckle types.</p>
<p>In this example, we can see that our elements are grouped under 8 lists. We&rsquo;ll transfer <strong>Floors</strong>, <strong>Structural Columns</strong>, <strong>Structural Foundations</strong>, <strong>Structural Framing</strong> and <strong>Walls</strong>.</p>
<p><img loading="lazy" src="images/3.2-ExpandSpeckleObject.png" alt="3.2-ExpandSpeckleObject.png"  />
</p>
<p>First, we&rsquo;ll use <strong>Merge</strong> node to merge these lists and then <strong>Expand</strong> it again to see the attributes of received objects.</p>
<p><img loading="lazy" src="images/3.3-Merge.png" alt="3.3-Merge.png"  />
</p>
<p>This time <strong>Expand Speckle Object</strong> node will output the attributes of the selected objects. In this tutorial we will use following attributes:</p>
<ul>
<li><strong>displayMesh</strong>: displayMesh contains the geometry of the element. It will be received as mesh geometry in Rhino.</li>
<li><strong>elementId</strong>: Revit Element Id of the selected element. We are going to use the value of it as the name of the geometry.</li>
<li><strong>type</strong>: Type name of the Revit element. An example is &ldquo;Generic Concrete 300mm&rdquo;. We will create a <strong>type</strong> attribute and set this as the value.</li>
<li><strong>speckle_type</strong>: Returns Speckle Type of the element.</li>
<li><strong>level</strong>: Level of the selected element. The value of this element will also be a Speckle Object and we only need the name of the level. So we will connect another expand Speckle object to get the parameter name.</li>
</ul>
<h3 id="speckle-object-value-by-key">Speckle Object Value by Key<a hidden class="anchor" aria-hidden="true" href="#speckle-object-value-by-key">#</a></h3>
<p>After we have the names of the attributes we are looking for, instead of connecting an <strong>Expand</strong> node, we can connect <strong>Speckle Object Value by Key</strong> node. This node expects an <strong>Object</strong> and a <strong>Key</strong>, and it returns the value of the given key.</p>
<p>We will connect the <strong>Merge</strong> result to the <strong>Object</strong> input of this node and connect the above parameters as the <strong>Key</strong> input.</p>
<p><img loading="lazy" src="images/4.1-SpeckleObjectValueByKey.png" alt="4.1-SpeckleObjectValueByKey.png"  />
</p>
<p>Now we have the keys and the values of the attributes, let&rsquo;s create them. For that, we will use <strong>Define Object Attributes</strong> from <strong>Elefront</strong>.</p>
<p><img loading="lazy" src="images/4.2-ElefronDefineObjectAttributes.png" alt="4.2-ElefronDefineObjectAttributes.png"  />
</p>
<ul>
<li><strong>User Keys</strong>: This will be the merged list of the keys. In our case, <strong>type</strong> and <strong>level</strong>.</li>
<li><strong>User Values</strong>: Again, Merged list of the values of those keys. But be careful, you should graft the inputs to have two items in each list, one for the type and one for the level. Otherwise, you will end up with two lists.</li>
<li><strong>Name</strong>: The values of the elementId key. This will also be grafted.</li>
<li><strong>Layer</strong>: Layer will be the category of the elements. Also grafted. But first we have to define the layers. For that, we will use <strong>Define Layer</strong> node from Elefront to create Layers from unique names.</li>
</ul>
<p>Do not forget to <strong>flatten</strong> the output depending on the structure of your lists.</p>
<p><img loading="lazy" src="images/4.3-AssignAttributesToGeometry.png" alt="4.3-AssignAttributesToGeometry.png"  />
</p>
<p>Now we created the attributes, let&rsquo;s add them to the geometry. We will use <code>Bake Objects</code> from <code>Elefront</code> to bake mesh geometry with their corresponding attributes. Let&rsquo;s give it a BakeName: &ldquo;<em>Revit to Rhino with Properties</em>&rdquo;. <strong>Bake</strong> input expects a <strong>Boolean</strong> so I will connect a <strong>Button</strong> to that. When I hit it, Boolean will turn True and it bakes the geometry.</p>
<p><img loading="lazy" src="images/4.4-BakeObjects.png" alt="4.4-BakeObjects.png"  />
</p>
<p>This will be the final result.</p>
<p><img loading="lazy" src="images/5.1-BakedGeometry.png" alt="5.1-BakedGeometry.png"  />
</p>
<p>Other than geometry, we also have the information embedded in the model üéâüéâ</p>
<p><img loading="lazy" src="images/5.2-GeometryAttributes.png" alt="5.2-GeometryAttributes.png"  />
</p>
<h2 id="coloring-by-attributes">Coloring by Attributes<a hidden class="anchor" aria-hidden="true" href="#coloring-by-attributes">#</a></h2>
<p>In the previous part, we embedded the properties. There are potential use cases for it and we will demonstrate the first thing that comes to mind: Coloring them by their attributes in Rhino.</p>
<p>Let&rsquo;s do itüí™!</p>
<h3 id="referencing-geometry">Referencing Geometry<a hidden class="anchor" aria-hidden="true" href="#referencing-geometry">#</a></h3>
<p>Lets start with referencing the geometry we baked. Since they are Mesh, we can use <strong>Reference by Type</strong> node and connect <strong>Mesh</strong> as the input.</p>
<p><img loading="lazy" src="images/6.1-ReferenceMeshGeometry.png" alt="6.1-ReferenceMeshGeometry.png"  />
</p>
<h3 id="get-attribute-values">Get Attribute Values<a hidden class="anchor" aria-hidden="true" href="#get-attribute-values">#</a></h3>
<p>Now we have the geometry, let&rsquo;s get the attribute values. We will use <strong>Get User Value</strong> and connect &ldquo;<strong>type</strong>&rdquo; string for the <strong>Key</strong> input. This will output Revit Type names as the output.</p>
<p><img loading="lazy" src="images/6.2-GetAttributeValues.png" alt="6.2-GetAttributeValues.png"  />
</p>
<h3 id="create-color-for-each-type">Create Color For Each Type<a hidden class="anchor" aria-hidden="true" href="#create-color-for-each-type">#</a></h3>
<p>Lets create a color for each unique types. We will convert our <strong>List</strong> to a <strong>Set</strong> to get unique items. Then we&rsquo;ll use <strong>Random Color</strong> from <strong>WombatGH</strong> to create a color for each item connected.</p>
<p><img loading="lazy" src="images/6.3-CreateColorForEachType.png" alt="6.3-CreateColorForEachType.png"  />
</p>
<h3 id="create-color-for-each-element">Create Color For Each Element<a hidden class="anchor" aria-hidden="true" href="#create-color-for-each-element">#</a></h3>
<p>Lets match these colors with corresponding elements. We&rsquo;ll use <strong>List Item</strong> to match the order of two lists and connect <strong>Map</strong> output of Set as the <strong>Index</strong> input of List Item.</p>
<p><img loading="lazy" src="images/6.4-AssignColorsToElements.png" alt="6.4-AssignColorsToElements.png"  />
</p>
<h3 id="add-color-to-geometry">Add Color to Geometry<a hidden class="anchor" aria-hidden="true" href="#add-color-to-geometry">#</a></h3>
<p>You&rsquo;ve made it so far, congratsüëè! Lets add colors to the geometry. First lets convert these colors to <strong>Elefront Attributes</strong>, then we have to modify the color attribute of the Rhino geometry and we will use <strong>Modify Rhino Attributes</strong> for that. Connect mesh geometry to the geometry input, Elefront attributes to the attributes input and a Boolean value of True to the modify input.</p>
<p><img loading="lazy" src="images/6.5-ModifyGeometryColors.png" alt="6.5-ModifyGeometryColors.png"  />
</p>
<p><img loading="lazy" src="images/7.1-ColorByType.png" alt="7.1-ColorByType.png"  />
</p>
<p><em>Colored by Type Attribute</em></p>
<p>Ta Da!üéäüéäüéä You&rsquo;ve made it. They are colored by their type attributes now! You can color it by any of its attributes. Try it yourselves. Below is colored by Level attribute instead of type.</p>
<p><img loading="lazy" src="images/7.2-ColorByLevel.png" alt="7.2-ColorByLevel.png"  />

<em>Colored by Level Attribute</em></p>
<hr>
<h2 id="conclusion"><strong>Conclusion</strong><a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>We hope you enjoyed this tutorial and found it useful!</p>
<p><strong>Speckle is an Open Source project</strong>¬†and we really ‚ù§Ô∏è feedback, so if you have any questions, comments, critiques, or praises please let us know on our¬†<strong><a href="https://speckle.community/">community forum</a></strong>.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://bimgeek.github.io/tags/english/">english</a></li>
      <li><a href="https://bimgeek.github.io/tags/revit/">revit</a></li>
      <li><a href="https://bimgeek.github.io/tags/excel/">excel</a></li>
      <li><a href="https://bimgeek.github.io/tags/dynamo/">dynamo</a></li>
      <li><a href="https://bimgeek.github.io/tags/speckle/">speckle</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://bimgeek.github.io/tutorials/visualizing-room-data-in-power-bi/">
    <span class="title">¬´ Prev Page</span>
    <br>
    <span>Visualizing Room Data in Power Bi</span>
  </a>
  <a class="next" href="https://bimgeek.github.io/tutorials/create-revit-sheets-from-excel/">
    <span class="title">Next Page ¬ª</span>
    <br>
    <span>Create Revit Sheets from Excel</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Revit Elements to Rhino Using Speckle on twitter"
        href="https://twitter.com/intent/tweet/?text=Revit%20Elements%20to%20Rhino%20Using%20Speckle&amp;url=https%3a%2f%2fbimgeek.github.io%2ftutorials%2frevit-elements-to-rhino-using-speckle%2f&amp;hashtags=english%2crevit%2cexcel%2cdynamo%2cspeckle">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Revit Elements to Rhino Using Speckle on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fbimgeek.github.io%2ftutorials%2frevit-elements-to-rhino-using-speckle%2f&amp;title=Revit%20Elements%20to%20Rhino%20Using%20Speckle&amp;summary=Revit%20Elements%20to%20Rhino%20Using%20Speckle&amp;source=https%3a%2f%2fbimgeek.github.io%2ftutorials%2frevit-elements-to-rhino-using-speckle%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Revit Elements to Rhino Using Speckle on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fbimgeek.github.io%2ftutorials%2frevit-elements-to-rhino-using-speckle%2f&title=Revit%20Elements%20to%20Rhino%20Using%20Speckle">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Revit Elements to Rhino Using Speckle on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fbimgeek.github.io%2ftutorials%2frevit-elements-to-rhino-using-speckle%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Revit Elements to Rhino Using Speckle on whatsapp"
        href="https://api.whatsapp.com/send?text=Revit%20Elements%20to%20Rhino%20Using%20Speckle%20-%20https%3a%2f%2fbimgeek.github.io%2ftutorials%2frevit-elements-to-rhino-using-speckle%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Revit Elements to Rhino Using Speckle on telegram"
        href="https://telegram.me/share/url?text=Revit%20Elements%20to%20Rhino%20Using%20Speckle&amp;url=https%3a%2f%2fbimgeek.github.io%2ftutorials%2frevit-elements-to-rhino-using-speckle%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://bimgeek.github.io/">BIMGEEK</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    menu.scrollLeft = localStorage.getItem("menu-scroll-position");
    menu.onscroll = function () {
        localStorage.setItem("menu-scroll-position", menu.scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
